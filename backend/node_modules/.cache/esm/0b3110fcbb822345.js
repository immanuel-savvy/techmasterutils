let express,cors,bodyParser,libre,fs,save_file,PDFNet;_bb8‍.w("express",[["default",["express"],function(v){express=v}]]);_bb8‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_bb8‍.w("body-parser",[["default",["bodyParser"],function(v){bodyParser=v}]]);_bb8‍.w("libreoffice-convert",[["default",["libre"],function(v){libre=v}]]);_bb8‍.w("fs",[["default",["fs"],function(v){fs=v}]]);_bb8‍.w("./utils",[["save_file",["save_file"],function(v){save_file=v}]]);_bb8‍.w("@pdftron/pdfnet-node",[["PDFNet",["PDFNet"],function(v){PDFNet=v}]]);







let main = async () => {
  await PDFNet.addResourceSearchPath("./");

  if (!(await PDFNet.StructuredOutputModule.isModuleAvailable())) {
    console.log("uh");
    return;
  }

  await PDFNet.Convert.fileToWord("./savvy.pdf", "savvy.docx");
};

// documentation/nodejs/guides/features/office/convert-to-office

PDFNet.runWithCleanup(
  main,
  "demo:1674987060797:7d5a1d8903000000002893e91db12901081a7713aa7f43e4b54cfdace1"
);

const app = express();
app.use(cors());
app.use(express.static(__dirname + "/files"));
app.use(bodyParser.urlencoded({ extended: true, limit: "100mb" }));
app.use(bodyParser.json({ limit: "100mb" }));

app.get("/", (req, res) => res.send("<div><h1>Hi, its Techmaster.</h1></div>"));

app.post("/pdf_to_word", (req, res) => {
  let { file } = req.body;

  let saved_file = save_file(file, ".docx");
  _bb8‍.g.console.log(saved_file, "saved file");

  libre.convert(
    fs.readFileSync(`${__dirname}/files/${saved_file}`),
    ".pdf",
    undefined,
    (err, done) => {
      if (err) {
        return _bb8‍.g.console.log(err);
      }
      _bb8‍.g.console.log(done);
    }
  );
});

app.listen(3300, () => {
  console.log("Techmaster Utils Backend started on :3300");
});

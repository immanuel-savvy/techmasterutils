let express,cors,bodyParser,domain,remove_file,save_file;_982‍.w("express",[["default",["express"],function(v){express=v}]]);_982‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_982‍.w("body-parser",[["default",["bodyParser"],function(v){bodyParser=v}]]);_982‍.w("./utils",[["domain",["domain"],function(v){domain=v}],["remove_file",["remove_file"],function(v){remove_file=v}],["save_file",["save_file"],function(v){save_file=v}]]);



let axios = require("axios");

process.on("uncaughtException", function (error) {
  _982‍.g.console.log(error.stack);
});

let api_base = "https://3ohk.aoscdn.com";

const app = express();
app.use(cors());
app.use(express.static(__dirname + "/files"));
app.use(bodyParser.urlencoded({ extended: true, limit: "100mb" }));
app.use(bodyParser.json({ limit: "100mb" }));

app.get("/", (req, res) => res.send("<div><h1>Hi, its Techmaster.</h1></div>"));

app.post("/pdf_to_word", async (req, res) => {
  let { file } = req.body;

  let saved_file = save_file(file, ".pdf");
  let input_file_url = `${domain}/${saved_file}`;

  let response = await axios.post(
    `${api_base}/api/tasks/conversion`,
    {
      url: input_file_url,
      format: "docx",
    },
    {
      headers: {
        "X-Api-Key": "wxk5s3og3tlopdeq5qfl",
        "Content-Type": "application/json",
      },
    }
  );

  _982‍.g.console.log(response.data);
  res.end();
});

app.listen(3300, () => {
  console.log("Techmaster Utils Backend started on :3300");
});
